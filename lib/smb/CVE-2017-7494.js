module.exports={
	tags:"smb,win,CVE-2017-7494",
    des:"smb,win,CVE-2017-7494,Vulnerability detection",
    dependencies:"java,ysoserial,base64,tr",
    VulApps:[],
    doIted:{},
	urls:["https://github.com/vulhub/vulhub/tree/master/samba/CVE-2017-7494"],
	doCheck:function (url,fnCbk)
	{
        url = url.trim().replace(/[\s\r\n]*/gmi,'');
        var _t = this,_s = this.self,hst = _s.parseUrl(url);
        hst.port = hst.port||(-1 < hst.protocol.indexOf("https")?443:80);
        var szK = `${hst.hostname}:${hst.port}`;
        if(_t.doIted[szK])return;
        // '${_s.g_szCmd}'| nc -vv -q 3 -n ${hst.hostname} ${hst.port}`
        var szPay1 = _s.child_process.execSync(``).toString("utf-8");
        _t.doIted[szK] = 1;
	}
};
